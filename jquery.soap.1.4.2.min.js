!function(e){function t(e){this.typeOf="SOAPEnvelope",this.prefix="soap",this.soapConfig=null,this.attributes={},this.headers=[],this.bodies=[];var t=e.name.split(":");if("Envelope"===t[1]||"Body"===t[1]){this.prefix=t[0],e.attr("xmlns:"+this.prefix)===d.SOAP11.namespaceURL&&(this.soapConfig=this.SOAP11),e.attr("xmlns:"+this.prefix)===d.SOAP12.namespaceURL&&(this.soapConfig=this.SOAP12);var s=e.find(this.prefix+":Envelope");if(s&&s.attributes)for(var n in s.attributes)this.addAttribute(n,s.attributes[n]);if(header=e.find(this.prefix+":Header"),header&&header.children)for(var i=0;i<header.children.length;i++)this.addHeader(header.children[i]);if(body=e.find(this.prefix+":Body"),body&&body.children)for(var a=0;a<body.children.length;a++)this.addBody(body.children[a]);else for(var r=0;r<e.children.length;r++)this.addBody(e.children[r])}else this.addBody(e)}function s(){i&&"object"==typeof console&&e.isFunction(console.log)&&(1==arguments.length?console.log(arguments[0]):console.log(arguments))}function n(){"object"==typeof console&&e.isFunction(console.warn)&&(1==arguments.length?console.warn(arguments[0]):console.warn(arguments))}var i,a={appendMethodToURL:!0,async:!0,enableLogging:!1,noPrefix:!1,soap12:!1};e.soap=function(r){var h={};if(r&&!r.params&&!r.data)return e.extend(a,r),i=r.enableLogging,s("jQuery.soap - globalConfig updated:",a),a;e.extend(h,a,r),i=h.enableLogging,s("jquery.soap - config:",h),d.fallbackDeprecated(h);var p=d.processData({data:h.data,name:h.elementName?h.elementName:h.method,prefix:h.namespaceQualifier&&!h.noPrefix?h.namespaceQualifier+":":"",namespaceURL:h.namespaceURL,namespaceQualifier:h.namespaceQualifier});if(p&&h.url){var u=new t(p);if(h.envAttributes)for(var c in h.envAttributes)u.addAttribute(c,h.envAttributes[c]);if(h.wss){var l=d.createWSS(h.wss);l&&u.addHeader(l)}return h.appendMethodToURL&&h.method&&(h.url+=h.method),u.send({url:h.url,async:h.async,headers:h.HTTPHeaders?h.HTTPHeaders:{},action:h.SOAPAction?h.SOAPAction:h.method,soap12:h.soap12,beforeSend:h.beforeSend}).done(function(t,n,i){var a=new o(n,i);s("jquery.soap - receive:",a.toXML().firstChild),e.isFunction(h.success)&&h.success(a)}).fail(function(t,n,i){s("jquery.soap - error:",i),e.isFunction(h.error)&&h.error(new o(n,t))})}p||n("jquery.soap - no soapObject"),h.url||n("jquery.soap - no url")},t.prototype={addAttribute:function(e,t){this.attributes[e]=t},addNamespace:function(e,t){this.addAttribute("xmlns:"+e,t)},addHeader:function(e){this.headers.push(e)},addBody:function(e){this.bodies.push(e)},toString:function(){var e=new r(this.prefix+":Envelope");for(var t in this.attributes)e.attr(t,this.attributes[t]);if(this.headers.length>0)for(var s=e.newChild(this.prefix+":Header"),n=0;n<this.headers.length;n++)s.appendChild(this.headers[n]);if(this.bodies.length>0)for(var i=e.newChild(this.prefix+":Body"),a=0;a<this.bodies.length;a++)i.appendChild(this.bodies[a]);return e.attr("xmlns:"+this.prefix)||e.addNamespace(this.prefix,this.soapConfig.namespaceURL),'<?xml version="1.0" encoding="UTF-8"?>'+e.toString()},send:function(t){var n=this;this.soapConfig||(this.soapConfig=t.soap12?d.SOAP12:d.SOAP11);var i=this.soapConfig.type;return i===d.SOAP11.type&&t.action&&(t.headers.SOAPAction=t.action),s("jquery.soap - beforeSend:",e.parseXML(this.toString()).firstChild),e.ajax({type:"POST",url:t.url,async:t.async,headers:t.headers,dataType:"xml",processData:!1,data:this.toString(),contentType:i+"; charset=UTF-8",xhrFields:{onprogress:function(e){e.lengthComputable?s("jquery.soap - progress:",e.loaded/e.total*100):s("jquery.soap - progress:","Length not computable.")}},beforeSend:function(){return e.isFunction(t.beforeSend)?t.beforeSend(n):void 0}})}};var r=function(e){this.typeOf="SOAPObject",this.name=e,this.ns={},this.attributes={},this._parent=null,this.children=[],this.value=void 0,this.attr=function(e,t){return e&&t?(this.attributes[e]=t,this):e?this.attributes[e]:this.attributes},this.val=function(e){return void 0===e?"true"===this.attr("nil")?null:this.value:null!==e?(this.value=e,this):(this.attr("nil","true"),this)},this.addNamespace=function(e,t){return this.ns[e]=t,this},this.appendChild=function(e){return e._parent=this,this.children.push(e),e},this.newChild=function(e){var t=new r(e);return this.appendChild(t),t},this.addParameter=function(e,t){var s=new r(e);return s.val(t),this.appendChild(s),this},this.hasChildren=function(){return this.children.length>0?!0:!1},this.find=function(e){if(this.name===e)return this;for(var t=0;t<this.children.length;t++){var s=this.children[t].find(e);if(s)return s}},this.end=this.parent=function(){return this._parent},this.toString=function(){var e,t=[],s={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"};t.push("<"+this.name);for(var n in this.ns)t.push(" xmlns:"+n+'="'+this.ns[n]+'"');for(var i in this.attributes)"string"==typeof this.attributes[i]&&t.push(" "+i+'="'+this.attributes[i]+'"');if(t.push(">"),this.hasChildren())for(var a in this.children){var r=this.children[a];"object"==typeof r&&"SOAPObject"===r.typeOf&&t.push(r.toString())}return this.value&&(e=this.value.match(/<!\[CDATA\[.*?\]\]>/)?this.value:this.value.replace(/[<>&"']/g,function(e){return s[e]}),t.push(e)),t.push("</"+this.name+">"),t.join("")}},o=function(t,s){this.typeOf="SOAPResponse",this.status=t,this.headers=s.getAllResponseHeaders().split("\n"),this.httpCode=s.status,this.httpText=s.statusText,this.content=void 0===s.responseXML?s.responseText:s.responseXML,this.toString=function(){if("string"==typeof this.content)return this.content;if(e.isXMLDoc(this.content))return d.dom2string(this.content);throw new Error("Unexpected Content: "+e.type(this.content))},this.toXML=function(){return e.isXMLDoc(this.content)?this.content:e.parseXML(this.content)},this.toJSON=function(){return e.xml2json?e.xml2json(this.content):void n("jQuery.soap: Missing JQuery Plugin 'xml2json'")}},d={SOAP11:{type:"text/xml",namespaceURL:"http://schemas.xmlsoap.org/soap/envelope/"},SOAP12:{type:"application/soap+xml",namespaceURL:"http://www.w3.org/2003/05/soap-envelope"},processData:function(t){var s;return"string"===e.type(t.data)&&/\S/.test(t.data)&&(t.data=e.parseXML(t.data)),e.isXMLDoc(t.data)?s=d.dom2soap(t.data.firstChild):e.isPlainObject(t.data)?t.name&&(s=d.json2soap(t.name,t.data,t.prefix),t.namespaceQualifier&&t.namespaceURL?s.addNamespace(t.namespaceQualifier,t.namespaceURL):t.namespaceURL&&s.attr("xmlns",t.namespaceURL)):e.isFunction(t.data)&&(s=t.data(r)),s},json2soap:function(e,t,s,n){var i,a;if(null===t)i=new r(s+e),i.attr("nil",!0);else if("object"==typeof t)if(t.constructor.toString().indexOf("Array")>-1)for(var o=0;o<t.length;o++)a=this.json2soap(e,t[o],s,n),n.appendChild(a);else if(t.constructor.toString().indexOf("String")>-1)i=new r(s+e),i.val(""+t);else{i=new r(s+e);for(var d in t)a=this.json2soap(d,t[d],s,i),a&&i.appendChild(a)}else i=new r(s+e),i.val(""+t);return i},dom2soap:function(e){for(var t=/^\s+$/,s=new r(e.nodeName),n=0;n<e.attributes.length;n++){var i=e.attributes[n];s.attr(i.name,i.value)}for(var a=0;a<e.childNodes.length;a++){var o=e.childNodes[a];if(1===o.nodeType){var h=d.dom2soap(o);s.appendChild(h)}3!==o.nodeType||t.test(o.nodeValue)||s.val(o.nodeValue),4===o.nodeType&&s.val("<![CDATA["+o.nodeValue+"]]>")}return s},dom2string:function(e){return"undefined"!=typeof XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml},createWSS:function(e){if(e.username&&e.password){var t={security:"wsse:Security",securityNS:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd",usernameToken:"wsse:UsernameToken",usernameTokenNS:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd",username:"wsse:Username",usernameType:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd",password:"wsse:Password",passwordType:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText",nonce:"wsse:Nonce",nonceType:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd",wsuCreated:"wsu:Created",wsuCreatedType:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"},s=new r(t.security).addNamespace("wsse",t.securityNS).addNamespace("wsu",t.usernameTokenNS).newChild(t.usernameToken).newChild(t.username).attr("Type",t.usernameType).val(e.username).end().newChild(t.password).attr("Type",t.passwordType).val(e.password).end().end(),n=s.find(t.usernameToken);return e.nonce&&n.newChild(t.nonce).attr("Type",t.nonceType).val(e.nonce),e.created&&n.newChild(t.wsuCreated).attr("Type",t.wsuCreatedType).val(e.created),s}},fallbackDeprecated:function(e){var t={namespaceUrl:"namespaceURL",request:"beforeSend",params:"data"};for(var s in t){var i=t[s];!e[i]&&e[s]&&(n("jquery.soap: "+s+" is deprecated, use "+i+" instead!"),e[i]=e[s],delete e[s])}}}}(jQuery);
